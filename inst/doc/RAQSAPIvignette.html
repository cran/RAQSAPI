<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to the RAQSAPI package</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>

<style type="text/css">
  p.abstract{
    text-align: center;
    font-weight: bold;
  }
  div.abstract{
    margin: auto;
    width: 90%;
  }
</style>


<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to the RAQSAPI package</h1>
<h4 class="author">Clinton Mccrowey</h4>
<address class="author_afil">
United States Environmental Protection Agency (US EPA),<br />
Region III,<br />
Air and Radiation Division,<br />
Air Quality and Analysis Branch<br><div class="abstract">
<p class="abstract">Abstract</p>
RAQSAPI is a package for R that connects the R programming language environment to the United States Environmental Protection Agency’s (US EPA) Air Quality System (AQS) Data Mart database API for retrieval of ambient air pollution data.
</div>



<div id="epa-disclaimer" class="section level1">
<h1>EPA Disclaimer</h1>
<p>This software/application was developed by the U.S. Environmental Protection Agency (USEPA). No warranty expressed or implied is made regarding the accuracy or utility of the system, nor shall the act of distribution constitute any such warranty. The USEPA has relinquished control of the information and no longer has responsibility to protect the integrity, confidentiality or availability of the information. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by the USEPA. The USEPA seal and logo shall not be used in any manner to imply endorsement of any commercial product or activity by the USEPA or the United States Government.</p>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th><span style="color:red"> Warning: US EPA’s AQS Data Mart API V2 is currently<br />
in beta phase of development, the API interface has not been finalized.<br />
This means that certain functionality of the API may change or be removed<br />
without notice. As a result, this package is also currently marked as beta and<br />
may also change to reflect any changes made to the Data Mart API or in respect<br />
to improvements in the design, functionality, quality and documentation of<br />
this package. The authors assume no liability for any problems that may occur<br />
as a result of using this package, the Data Mart service, any software,<br />
service, hardware, or user accounts that may utilize this package. </span></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>RAQSAPI</code> package for the R programming environment allows a R programming environment to connect to and retrieve data from the United States Environmental Protection Agency’s (US EPA) Air Quality System (AQS) Data Mart API v2 (Air Quality System)<span class="citation"><sup>1</sup></span> interface directly. This package enables the data user to omit legacy challenges including coercing data from a JSON object to a usable R object, retrieving multiple years of data, formatting API requests, retrieving results, handling credentials, requesting multiple pollutant data and rate limiting data requests. All the basic functionality of the API have been implemented that are available from the AQS API Data Mart server. The library connects to AQS Data Mart API via Hypertext Transfer Protocol (HTTP) so there is no need to install external ODBC drivers, configure ODBC connections or deal with the security vulnerabilities associated with them. Most functions have a parameter, return_header which by default is set to FALSE. If the user decides to set return_header to TRUE, then that function will return a R AQS_DATAMART_APIv2 S3 object which is a two item named list.<br />
The first item, ($Header) in the AQS_DATAMART_APIv2 object is a (tibble)<span class="citation"><sup>2</sup></span> which contains the header information. The Header contains status information regarding the request (success/fail), any applicable error messages returned from the API, if any exist, the URL used in the request, a date and time stamp noting when request was received and other useful information. The second item of the AQS_DATAMART_APIv2 object ($Data) is a tibble which contains the actual data being requested. For functions with the return_header option set to FALSE (default) a simple tibble is returned with just the $Data portion of the request. After each call to the API a five second stall is invoked to help prevent overloading the Data Mart API server and to serve as a simple rate limit.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</div>
<div id="installing-raqsapi" class="section level1">
<h1>Installing RAQSAPI</h1>
<p>Either install the stable version from CRAN or install the latest development version from GitHub.</p>
<div id="option-1-installing-the-stable-version-from-cran" class="section level2">
<h2>Option 1: Installing the stable version from CRAN</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="at">pkgs=</span><span class="st">&quot;RAQSAPI&quot;</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span> )</span></code></pre></div>
</div>
<div id="option-2-installing-the-development-version-of-raqsapi" class="section level2">
<h2>Option 2: Installing the development version of RAQSAPI</h2>
<p>To install the development version of <code>RAQSAPI</code>, first if not already installed, install the <code>remotes</code> package and its dependencies. Then run the following in a R environment.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="at">repo =</span> <span class="st">&quot;USEPA/raqsapi&quot;</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dependencies =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">upgrade =</span> <span class="st">&quot;always&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">build =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#optional, set TRUE if the manual is desired,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#requires pandoc</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">build_manual =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">build_vignettes =</span> <span class="cn">TRUE</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                        )</span></code></pre></div>
</div>
</div>
<div id="using-the-raqsapi-library" class="section level1">
<h1>Using The RAQSAPI library</h1>
<div id="load-raqsapi" class="section level2">
<h2>Load RAQSAPI</h2>
<p>after successfully installing the <code>RAQSAPI</code> package, load the <code>RAQSAPI</code> library:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RAQSAPI)</span></code></pre></div>
</div>
<div id="sign-up-and-setting-up-user-credentials-with-the-raqsapi-library" class="section level2">
<h2>Sign up and setting up user credentials with the RAQSAPI library</h2>
<p>If you have not already done so you will need to sign up with AQS Data Mart using aqs_sign_up function,<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> this function takes one input, “email,” which is a R character object, that represents the email address that you want to use as a user credential to the AQS Data Mart service. After a successful call to aqs_sign_up an email message will be sent to the email address provided with a new Data Mart key which will be used as a credential key to access the Data Mart API. The aqs_sign_up function can also be used to regenerate a new key for an existing user, to generate a new key simply call the aqs_sign_up function with the parameter “email” set to an existing account. A new key will be e-mailed to the account given.</p>
<p>The credentials used to access the Data Mart API service are stored in a R environment variable that needs to be set every time the <code>RAQSAPI</code> library is attached or the key is changed. Without valid credentials, the Data Mart server will reject any request sent to it. The key used with Data Mart is a key and is not a password, so the RAQSAPI library does not treat the key as a password; this means that the key is stored in plain text and there are no attempts to encrypt Data Mart credentials as would be done for a username and password combination. The key that is supplied to use with Data Mart is not intended for authentication but only account monitoring. Each time RAQSAPI is loaded and before using any of it’s functions use the aqs_credentials<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> function to enter in the user credentials so that RAQSAPI can access the AQS Data Mart server.</p>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th><span style="color:red"> Note: The credentials used to access AQS Data Mart<br />
API is not the same as the credentials used to access AQS. AQS users who do<br />
not have access to the AQS Data Mart will need to create new credentials.<br />
</span></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<div id="suggested-use-the-keyring-package-to-manage-credentials" class="section level2">
<h2>(suggested) Use the <code>keyring</code> package to manage credentials</h2>
<p>It is highly suggested that users use a keyring manager to store and retrieve their credentials while using RAQSAPI. One such credential manager is provided by the <code>keyring</code> package.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> The <code>Keyring</code> package uses the credential manager available for most popular operating systems to store and manage user credentials. This will help avoid hard coding credential information into R scripts.</p>
<p>To use the <code>keyring</code> package with <code>RAQSAPI</code> first install <code>keyring</code>:</p>
<blockquote>
<p>install.package(“keyring”)</p>
</blockquote>
<p>Ensure that your system is supported by the <code>keyring</code> package before proceeding.</p>
<blockquote>
<p>keyring::has_keyring_support()</p>
</blockquote>
<p>then set the keyring used to access AQS Data Mart (make sure to replace the text in the angled brackets with your specific user information):</p>
<blockquote>
<p>library(“keyring”) keyring::key_set(service = “AQSDatamart,” username = “&lt;user email account&gt;”)</p>
</blockquote>
<p>a popup window will appear for the user to input their keyring information. Enter the AQS Data mart credential key associated with the AQS user name provided, then hit enter. Now the AQS Data Mart user credential is set using <code>keyring</code>.</p>
<p>To retrieve the keyring to use with <code>RAQSAPI</code> load the <code>keyring</code> package and use the function key_get to return the user credential to RAQSAPI:</p>
<blockquote>
<p>library(RAQSAPI) library(keyring) datamartAPI_user &lt;- &lt;user email account&gt; server &lt;- “AQSDatamart”</p>
</blockquote>
<p>then pass these variables to the aqs_credentials function when using RAQSAPI:</p>
<blockquote>
<p>aqs_credentials(username = datamartAPI_user, key = key_get(service = server, username = datamartAPI_user ) )</p>
</blockquote>
<p>To change the keyring stored with the <code>keyring</code> package repeat the steps above to call the keyring::key_set function again with the new credential information.</p>
<p>To retrieve a list of all keyrings managed with the <code>keyring</code> package use the function: &gt; keyring::key_list()</p>
<p>Refer the the<a href="https://cran.r-project.org/package=keyring/readme/README.html"><code>keyring</code> package documentation</a> for an in depth explanation on using the <code>keyring</code> package.</p>
</div>
<div id="usage-tips-and-precautions" class="section level2">
<h2>Usage tips and precautions</h2>
<p>This section contains suggestions for completing certain data related tasks.</p>
<ul>
<li>Determine if or how much data exists for a time-parameter-geography combination:
<ul>
<li>Retrieve data using the annualdata service.</li>
<li>If no records are returned, we do not have the data.</li>
<li>If records are returned, use the observation count to determine the temporal and geographic distribution of the data.</li>
</ul></li>
<li>Monthly averages:
<ul>
<li>AQS does not routinely calculate monthly aggregate statistics.</li>
<li>If you need these, you must calculate them yourself.</li>
<li>These can be calculated from the sample data or the daily data without loss of fidelity.</li>
</ul></li>
<li>Determine a single value for a site with collocated monitors:
<ul>
<li>Many sites will have collocated monitors - monitors collecting the same parameter at the same time.</li>
<li>The API currently provides only monitor level values. (site-level values will be added in the future.)</li>
<li>For some criteria pollutants (PM2.5, ozone, lead, and NO2), the regulations define procedures for defining a single site-level value.</li>
<li>For other pollutants, determining a single site-level value is left to the investigator.</li>
</ul></li>
<li><strong>Please adhere to the following when using the AQS Data Mart API</strong>:
<ul>
<li><strong>Limit the size of queries</strong>. The AQS Data Mart contains billions of values and you may request more than you intend. If you are unsure of the amount of data, start small and work your way up. Please limit queries to 1,000,000 rows of data each. You can use the “observation count” field on the annualdata service to determine how much data exists for a time-parameter-geography combination.<br />
</li>
<li><strong>Limit the frequency of queries</strong>. The AQS Data Mart can process a limited load. Please wait for one request to complete before submitting another and do not make more than 10 requests per minute.</li>
<li>Be advised that RAQSAPI is capable of retrieving results for multiple pollutants, this can result in the amount of data being returned being multiplied by the number of pollutants being requested.</li>
<li>Be advised that the AQS Data Mart API limits certain data requests to one year of data at a time with the exception of the Monitor service. In order to retrieve multiple years of data for these functions the RAQSAPI library conveniently sends multiple API requests to the Data Mart API server, one request for each year, this can result in the amount of data being returned being multiplied by the number of years of data being requested.</li>
</ul></li>
</ul>
<p><strong>The AQS Data Mart administrators may disable accounts without notice for failure to adhere to these terms (Though they will contact the offending user via the email address provided)</strong></p>
</div>
</div>
<div id="raqsapi-functions" class="section level1">
<h1>RAQSAPI functions</h1>
<p>The RAQSAPI library exports the following functions (in alphabetical order):</p>
<pre><code>aqs_annualsummary_by_box  
aqs_annualsummary_by_cbsa  
aqs_annualsummary_by_county  
aqs_annualsummary_by_site  
aqs_annualsummary_by_state  
aqs_cbsas  
aqs_classes  
aqs_counties_by_state  
aqs_credentials  
aqs_dailysummary_by_box  
aqs_dailysummary_by_cbsa  
aqs_dailysummary_by_county  
aqs_dailysummary_by_site  
aqs_dailysummary_by_state  
aqs_fields_by_service  
aqs_isavailable  
aqs_knownissues  
aqs_mas  
aqs_monitors_by_box  
aqs_monitors_by_cbsa  
aqs_monitors_by_county  
aqs_monitors_by_site  
aqs_monitors_by_state  
aqs_parameters_by_class  
aqs_pqaos  
aqs_qa_annualPeferomanceeval_by_county  
aqs_qa_annualPeferomanceeval_by_MA  
aqs_qa_annualPeferomanceeval_by_pqao  
aqs_qa_annualPeferomanceeval_by_site  
aqs_qa_annualPeferomanceeval_by_state  
aqs_qa_annualPeferomanceevaltransaction_by_county  
aqs_qa_annualPeferomanceevaltransaction_by_MA  
aqs_qa_annualPeferomanceevaltransaction_by_pqao  
aqs_qa_annualPeferomanceevaltransaction_by_site  
aqs_qa_annualPeferomanceevaltransaction_by_state  
aqs_qa_blanks_by_county  
aqs_qa_blanks_by_MA  
aqs_qa_blanks_by_pqao  
aqs_qa_blanks_by_site  
aqs_qa_blanks_by_state  
aqs_qa_collocated_assessments_by_county  
aqs_qa_collocated_assessments_by_MA  
aqs_qa_collocated_assessments_by_pqao  
aqs_qa_collocated_assessments_by_site  
aqs_qa_collocated_assessments_by_state  
aqs_qa_flowrateaudit_by_county  
aqs_qa_flowrateaudit_by_MA  
aqs_qa_flowrateaudit_by_pqao  
aqs_qa_flowrateaudit_by_site  
aqs_qa_flowrateaudit_by_state  
aqs_qa_flowrateverification_by_county  
aqs_qa_flowrateverification_by_MA  
aqs_qa_flowrateverification_by_pqao  
aqs_qa_flowrateverification_by_site  
aqs_qa_flowrateverification_by_state  
aqs_qa_one_point_qc_by_county  
aqs_qa_one_point_qc_by_MA  
aqs_qa_one_point_qc_by_pqao  
aqs_qa_one_point_qc_by_site  
aqs_qa_one_point_qc_by_state  
aqs_qa_pep_audit_by_county  
aqs_qa_pep_audit_by_MA  
aqs_qa_pep_audit_by_pqao  
aqs_qa_pep_audit_by_site  
aqs_qa_pep_audit_by_state  
aqs_quarterlysummary_by_box  
aqs_quarterlysummary_by_county  
aqs_quarterlysummary_by_pqao  
aqs_quarterlysummary_by_site  
aqs_quarterlysummary_by_state  
aqs_removeheader  
aqs_revisionhistory  
aqs_sampledata_by_box  
aqs_sampledata_by_cbsa  
aqs_sampledata_by_county  
aqs_sampledata_by_site  
aqs_sampledata_by_state  
aqs_sampledurations  
aqs_sign_up  
aqs_sites_by_county  
aqs_states  
aqs_transactionsample_by_county  
aqs_transactionsample_by_site  
aqs_transactionsample_by_state  
aqs_transactionsample_by_MA</code></pre>
<p>RAQSAPI functions are named according to the service and filter variables that are available by the AQS Data Mart API.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
</div>
<div id="variable-descriptions-and-usage." class="section level1">
<h1>Variable descriptions and usage.</h1>
<p>These are all the available variables that can be used with various functions exported from the RAQSAPI library listed alphabetically. Not all of these variables are used with every function, and not all of these parameters are required. See the <a href="#RAQSAPI%20functional%20families">RAQSAPI functional families</a> section to see which parameters are used with each function.</p>
<ul>
<li><p>AQSobject: a R S3 object that is returned from RAQSAPI aggregate functions where return_header is TRUE. An AQS_Data_Mart_APIv2 is a 2 item named list in which the first item ($Header) is a tibble of header information from the AQS API and the second item ($Data) is a tibble of the data returned.</p></li>
<li><p>bdate: a R date object which represents the begin date of the data selection. Only data on or after this date will be returned.</p></li>
<li><p>cbdate (optional): a R date object which represents the “beginning date of last change” that indicates when the data was last updated. cbdate is used to filter data based on the change date. Only data that changed on or after this date will be returned. This is an optional variable which defaults to NA.</p></li>
<li><p>cedate (optional): a R date object which represents the “end date of last change” that indicates when the data was last updated. cedate is used to filter data based on the change date. Only data that changed on or before this date will be returned. This is an optional variable which defaults to NA.</p></li>
<li><p>countycode: a R character object which represents the 3 digit state FIPS code for the county being requested (with leading zero(s)). Refer to [aqs_counties_by_state()] for a table of available county codes for each state.</p></li>
<li><p>duration (optional): a R character string that represents the parameter duration code that limits returned data to a specific sample duration. The default value of NA_character_ will result in no filtering based on duration code. Valid durations include actual sample durations and not calculated durations such as 8 hour CO or O<span class="math inline">\({_3}\)</span> rolling averages, 3/6 day PM averages or Pb 3 month rolling averages. Refer to [aqs_sampledurations()] for a table of all available duration codes.</p></li>
<li><p>edate: a R date object which represents the end date of the data selection. Only data on or before this date will be returned.</p></li>
<li><p>email: a R character object which represents the email account that will be used to register with the AQS API or change an existing user’s key. A verification email will be sent to the account specified.</p></li>
<li><p>key: the key used in conjunction with the username given to connect to AQS Data Mart.</p></li>
<li><p>MA_code: a R character object which represents the 4 digit AQS Monitoring Agency code (with leading zeroes).</p></li>
<li><p>maxlat: a R character object which represents the maximum latitude of a geographic box. Decimal latitude with north begin positive. Only data south of this latitude will be returned.</p></li>
<li><p>maxlon: a R character object which represents the maximum longitude of a geographic box. Decimal longitude with east being positive. Only data west of this longitude will be returned. Note that -80 is less than -70.</p></li>
<li><p>minlat: a R character object which represents the minimum latitude of a geographic box. Decimal latitude with north being positive. Only data north of this latitude will be returned.</p></li>
<li><p>minlon: a R character object which represents the minimum longitude of a geographic box. Decimal longitude with east begin positive. Only data east of this longitude will be returned.</p></li>
<li><p>parameter: a R character list or single character object which represents the parameter code of the air pollutant related to the data being requested.</p></li>
<li><p>return_header If FALSE (default) only returns data requested. If TRUE returns a AQSAPI_v2 object which is a two item list that contains header information returned from the API server mostly used for debugging purposes in addition to the data requested.</p></li>
<li><p>service a string which represents the services provided by the AQS API. For a list of available services refer to <a href="https://aqs.epa.gov/aqsweb/documents/data_api.html#services" class="uri">https://aqs.epa.gov/aqsweb/documents/data_api.html#services</a> for the complete listing of services available through the Datamart API</p></li>
<li><p>sitenum: a R character object which represents the 4 digit site number (with leading zeros) within the county and state being requested.</p></li>
<li><p>stateFIPS: a R character object which represents the 2 digit state FIPS code (with leading zero) for the state being requested.</p></li>
<li><p>pqao_code: a R character object which represents the 4 digit AQS Primary Quality Assurance Organization code (with leading zeroes).</p></li>
<li><p>username: a R character object which represents the email account that will be used to connect to the AQS API.</p></li>
</ul>
<p><a name="RAQSAPI families of functions"> </a></p>
</div>
<div id="raqsapi-functional-families" class="section level1">
<h1>RAQSAPI functional families</h1>
<div id="sign-up-and-credentials" class="section level2">
<h2>Sign up and credentials</h2>
<p>The functions included in this family of functions are:</p>
<pre><code>aqs_credentials  
aqs_sign_up</code></pre>
<p>These functions are used to sign up with Data Mart and to store credential information to use with RAQSAPI. The RAQSAPI::aqs_signup function takes one parameter:</p>
<ul>
<li>email:</li>
</ul>
<p>The RAQSAPI::aqs_credentials function takes two parameters:</p>
<ul>
<li>username:</li>
<li>key:</li>
</ul>
</div>
<div id="data-mart-api-metadata-functions" class="section level2">
<h2>Data Mart API metadata functions</h2>
<pre><code>aqs_isavailable  
aqs_knownissues</code></pre>
<p>These functions return Data Mart meta data</p>
<p>The RAQSAPI::aqs_isavailable function takes no parameters and returns a table which details the status of the AQS API.</p>
<p>The RAQSAPI::aqs_field_by_Service function takes one parameter, service, which is a R character object which represents the services provided by the AQS API. For a list of available services see <a href="https://aqs.epa.gov/aqsweb/documents/data_api.html#services">Air Quality System (AQS) API - Services Overview</a></p>
<p>The RAQSAPI::aqs_knownissues function takes no parameters and Returns a table of any known issues with system functionality or the data. These are usually issues that have been identified internally and will require some time to correct in Data Mart or the API. This function implements a direct API call to Data Mart and returns data directly from the API. Issues returned via this function do not include any issues from the RAQSAPI R package.</p>
<p>The RAQSAPI::aqs_revisionhistory function is used to query Data Mart for the change history to the API.</p>
</div>
<div id="data-mart-api-list-functions" class="section level2">
<h2>Data Mart API list functions</h2>
<pre><code>aqs_cbsas  
aqs_classes  
aqs_counties_by_state  
aqs_mas  
aqs_pqaos  
aqs_sites_by_county  
aqs_states</code></pre>
<p>List functions return options or groupings that can be used in conjunction with other API calls. By default each function in this category returns results as a tibble. If return_header parameter is set to TRUE a AQSAPI_v2 object is returned instead.</p>
<p>RAQSAPI::aqs_cbsas returns a table of all available Core Based Statistical Areas (cbsas) and their respective cbsa codes.</p>
<p>RAQSAPI::aqs_states takes no arguments and returns a table of the available states and their respective state FIPS codes.</p>
<p>RAQSAPI::aqs_sampledurations takes no arguments and returns a table of the available sample duration code used to construct other requests.</p>
<p>RAQSAPI::aqs_classes takes no arguments and returns a table of parameter classes (groups of parameters, i.e. “criteria” or “all”).</p>
<p>RAQSAPI::aqs_counties_by_state takes one parameter, stateFIPS, which is a two digit state FIPS code for the state being requested represented as a R character object and returns a table of counties and their respective FIPS code for the state requested. Use RAQSAPI::aqs_states to receive a table of valid state FIPS codes.</p>
<p>RAQSAPI::aqs_sites_by_county takes two parameters, stateFIPS, which is a two digit state FIPS code for the state being requested and county_code which is a three digit county FIPS code for the county being requested, both stateFIPS and county_code should be encoded as a R character object This function returns a table of all air monitoring sites with the requested state and county FIPS code combination.</p>
<p>RAQSAPI::aqs_pqaos takes no parameters and returns an AQS_DATAMART_APIv2 S3 object containing a table of primary quality assurance organizations (pqaos).</p>
<p>RAQSAPI::aqs_mas takes no parameters and returns an AQS_DATAMART_APIv2 S3 object containing a table of monitoring agencies (MA).</p>
</div>
<div id="data-mart-aggregate-functions" class="section level2">
<h2>Data Mart aggregate functions</h2>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th><span style="color:blue"> Information: AQS Data Mart API restricts the<br />
maximum amount of monitoring data to one full year of data per<br />
API call. These functions are able to return multiple years of data by<br />
making repeated calls to the API. Each call to the Data Mart API will take<br />
time to complete. The more years of data being requested the longer RAQSAPI<br />
will take to return the results.</span></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>These functions retrieve aggregated data from the Data Mart API and are grouped by how each function aggregates the data. There are 5 different families of related aggregate functions. These families are arranged by how the Data Mart API groups the returned data, _by_site, _by_county, _by_state, <em>by</em><latitude longitude bounding box> (_by_box) and <em>by</em><core based statistical area> (_by_cbsa). Within each family of aggregated data functions there are functions that call on the 10 different services that the Data Mart API provides. All Aggregate functions return a tibble by default. If the return_Header parameter is set to TRUE an AQS_DATAMART_APIv2 S3 object is returned instead.</p>
<ul>
<li><strong>These fourteen services are</strong>:</li>
</ul>
<ol style="list-style-type: decimal">
<li><p><strong>Monitors</strong>: Returns operational information about the samplers (monitors) used to collect the data. Includes identifying information, operational dates, operating organizations, etc. Functions using this service contain <em>*monitors_by_</em>* in the function name.</p></li>
<li><p><strong>Sample Data</strong>: Returns sample data - the most fine grain data reported to EPA. Usually hourly, sometimes 5-minute, 12-hour, etc. This service is available in several geographic selections based on geography: site, county, state, cbsa (core based statistical area, a grouping of counties), or by latitude/longitude bounding box. Functions using this service contain <em>*sampledata_by_</em>* in the function name. All Sample Data functions accept two additional, optional parameters; cbdate and cedate:</p>
<ul>
<li>cbdate: a R date object which represents a “beginning date of last change” that indicates when the data was last updated. cbdate is used to filter data based on the change date. Only data that changed on or after this date will be returned. This is an optional variable which defaults to NA_Date_.</li>
<li>cedate: a R date object which represents an “end date of last change” that indicates when the data was last updated. cedate is used to filter data based on the change date. Only data that changed on or before this date will be returned. This is an optional variable which defaults to NA_Date_.</li>
<li>duration: an optional R character string that represents the parameter duration code that limits returned data to a specific sample duration. The default value of NA_character_ results in no filtering based on duration code. Valid durations include actual sample durations and not calculated durations such as 8 hour CO or <span class="math inline">\(O_3\)</span> rolling averages, 3/6 day PM averages or Pb 3 month rolling averages. Refer to [aqs_sampledurations()] for a list of all available duration codes.</li>
</ul></li>
<li><p><strong>Daily Summary Data</strong>: Returns data summarized at the daily level. All daily summaries are calculated on midnight to midnight basis in local time. Variables returned include date, mean value, maximum value, etc. Functions using this service contain <em>*dailydata_by_</em>* in the function name. All Daily Summary Data functions accept two additional parameters; cbdate and cedate:</p>
<ul>
<li>cbdate: a R date object which represents a “beginning date of last change” that indicates when the data was last updated. cbdate is used to filter data based on the change date. Only data that changed on or after this date will be returned. This is an optional variable which defaults to NA_Date_.</li>
<li>cedate: a R date object which represents an “end date of last change” that indicates when the data was last updated. cedate is used to filter data based on the change date. Only data that changed on or before this date will be returned. This is an optional variable which defaults to NA_Date_.</li>
</ul></li>
<li><p><strong>Annual Summary Data</strong>: Returns data summarized at the yearly level. Variables include mean value, maxima, percentiles, etc. Functions using this service contain <em>*annualdata_by_</em>* in the function name. All Annual Summary Data functions accept two additional parameters; cbdate and cedate:</p>
<ul>
<li>cbdate: a R date object which represents a “beginning date of last change” that indicates when the data was last updated. cbdate is used to filter data based on the change date. Only data that changed on or after this date will be returned. This is an optional variable which defaults to NA_Date_.</li>
<li>cedate: a R date object which represents an “end date of last change” that indicates when the data was last updated. cedate is used to filter data based on the change date. Only data that changed on or before this date will be returned. This is an optional variable which defaults to NA_Date_.</li>
</ul></li>
<li><p><strong>Quarterly Summary Data</strong>: Returns data summarized at the quarterly level. Variables include mean value, maxima, percentiles, etc. Functions using this service contain <em>*quarterlydata_by_</em>* in the function name. All Annual Summary Data functions accept two additional parameters; cbdate and cedate:</p>
<ul>
<li>cbdate: a R date object which represents a “beginning date of last change” that indicates when the data was last updated. cbdate is used to filter data based on the change date. Only data that changed on or after this date will be returned. This is an optional variable which defaults to NA_Date_.</li>
<li>cedate: a R date object which represents an “end date of last change” that indicates when the data was last updated. cedate is used to filter data based on the change date. Only data that changed on or before this date will be returned. This is an optional variable which defaults to NA_Date_.</li>
</ul></li>
<li><p><strong>Quality Assurance - Blanks Data</strong>: Quality assurance data - blanks samples. Blanks are unexposed sample collection devices (e.g., filters) that are transported with the exposed sample devices to assess if contamination is occurring during the transport or handling of the samples. Functions using this service contain <em>*qa_blanks_by_</em>* in the function name.<br />
</p></li>
<li><p><strong>Quality Assurance - Collocated Assessments</strong>: Quality assurance data - collocated assessments. Collocated assessments are pairs of samples collected by different samplers at the same time and place. (These are “operational” samplers, assessments with independently calibrated samplers are called “audits.”). Functions using this service contain <em>*qa_collocated_assessments_by_</em>* in the function name.</p></li>
<li><p><strong>Quality Assurance - Flow Rate Verifications</strong>: Quality assurance data - flow rate verifications. Several times per year, each PM monitor must have it’s (fixed) flow rate verified by an operator taking a measurement of the flow rate. Functions using this service contain <em>*qa_flowrateverification_by_</em>* in the function name.</p></li>
<li><p><strong>Quality Assurance - Flow Rate Audits</strong>: Quality assurance data - flow rate audits. At least twice year, each PM monitor must have it’s flow rate measurement audited by an expert using a different method than is used for flow rate verifications. Functions using this service contain <em>*qa_flowrateaudit_by_</em>* in the function name.</p></li>
<li><p><strong>Quality Assurance - One Point Quality Control Raw Data</strong>: Quality assurance data - one point quality control check raw data. At least every two weeks, certain gaseous monitors must be challenged with a known concentration to determine monitor performance. Functions using this service contain <em>*qa_one_point_qc_by_</em>* in the function name.<br />
</p></li>
<li><p><strong>Quality Assurance - pep Audits</strong>: Quality assurance data - performance evaluation program (pep) audits. pep audits are independent assessments used to estimate total measurement system bias with a primary quality assurance organization. Functions using this service contain <em>*qa_pep_audit_by_</em>* in the function name.</p></li>
<li><p><strong>Transaction Sample - AQS Submission data in transaction format (RD)</strong>: Transaction sample data - The raw transaction sample data uploaded to AQS by the agency responsible for data submissions in RD format. Functions using this service contain <em>*transactionsample_by_</em>* in the function name. Transaction sample data is only available aggregated by site, county, state or monitoring agency.</p></li>
<li><p><strong>Quality Assurance - Annual Performance Evaluations</strong>: Quality assurance data - Annual performance evaluations. A performance evaluation must be conducted on each primary monitor once per year. The percent differences between known and measured concentrations at several levels are used to assess the quality of the monitoring data. Functions using this service contain <em>*aqs_qa_annualpeferomanceeval_by_</em>* in the function name. Annual performance in transaction format are only available aggregated by site, county, state, monitoring agency, and primary quality assurance organization. Annual performance evaluations are only available aggregated by site, county, state, monitoring agency, and primary quality assurance organization.</p></li>
<li><p><strong>Quality Assurance - Annual performance Evaluations in transaction</strong><br />
<strong>format (RD)</strong>: Quality assurance data - The raw transaction annual performance evaluations data in RD format. Functions using this service contain <em>*aqs_qa_annualperformanceevaltransaction_by_</em>* in the function name. Annual performance evaluations in transaction format are only available aggregated by site, county, state, monitoring agency, and primary quality assurance organization.</p></li>
</ol>
<div id="data-mart-aggregate-functions-_by_site" class="section level3">
<h3>Data Mart aggregate functions _by_site</h3>
<pre><code>aqs_annualsummary_by_site  
aqs_dailysummary_by_site  
aqs_monitors_by_site  
aqs_qa_annualPeferomanceeval_by_site  
aqs_qa_annualPeferomanceevaltransaction_by_site  
aqs_qa_blanks_by_site  
aqs_qa_collocated_assessments_by_site  
aqs_qa_flowrateaudit_by_site  
aqs_qa_flowrateverification_by_site  
aqs_qa_one_point_qc_by_site  
aqs_qa_pep_audit_by_site  
aqs_quarterlysummary_by_site  
aqs_sampledata_by_site  
aqs_transactionsample_by_site</code></pre>
<p>functions in this family of functions aggregate data at the site level. All *_by_site functions accept the following variables:</p>
<ul>
<li>parameter:</li>
<li>bdate:</li>
<li>edate:</li>
<li>stateFIPS:</li>
<li>countycode:</li>
<li>sitenum:</li>
<li>cbdate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* functions and <em>*quarterlysummary_by_</em>* functions).</li>
<li>cedate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* functions and <em>*quarterlysummary_by_</em>* functions).</li>
<li>return_header (optional): set to FALSE by default.</li>
<li>duration (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>* functions).</li>
</ul>
</div>
<div id="data-mart-aggregate-functions-_by_county" class="section level3">
<h3>Data Mart aggregate functions _by_county</h3>
<pre><code>aqs_annualsummary_by_county  
aqs_dailysummary_by_county  
aqs_monitors_by_county  
aqs_qa_annualPeferomanceeval_by_county  
aqs_qa_annualPeferomanceevaltransaction_by_county  
aqs_qa_blanks_by_county  
aqs_qa_collocated_assessments_by_county  
aqs_qa_flowrateaudit_by_county  
aqs_qa_flowrateverification_by_county  
aqs_qa_one_point_qc_by_county  
aqs_qa_pep_audit_by_county  
aqs_quarterlysummary_by_county  
aqs_sampledata_by_county  
aqs_sites_by_county  
aqs_transactionsample_by_county</code></pre>
<p>functions in this family of functions aggregate data at the county level. All functions accept the following variables:</p>
<ul>
<li>parameter:</li>
<li>bdate:</li>
<li>edate:</li>
<li>stateFIPS:</li>
<li>countycode:</li>
<li>cbdate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>cedate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>return_header (optional): set to FALSE by default.</li>
<li>duration (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>* functions).</li>
</ul>
</div>
<div id="data-mart-aggregate-functions-by-monitoring-agency-ma" class="section level3">
<h3>Data Mart aggregate functions by Monitoring agency (MA)</h3>
<pre><code>aqs_annualsummary_by_state  
aqs_counties_by_state  
aqs_dailysummary_by_state  
aqs_monitors_by_state  
aqs_qa_annualPeferomanceeval_by_state  
aqs_qa_annualPeferomanceevaltransaction_by_state  
aqs_qa_blanks_by_state  
aqs_qa_collocated_assessments_by_state  
aqs_qa_flowrateaudit_by_state  
aqs_qa_flowrateverification_by_state  
aqs_qa_one_point_qc_by_state  
aqs_qa_pep_audit_by_state  
aqs_quarterlysummary_by_state  
aqs_sampledata_by_state  
aqs_transactionsample_by_state</code></pre>
<p>functions in this family of functions aggregate data at the state level. All functions accept the following variables:</p>
<ul>
<li>parameter:</li>
<li>bdate:</li>
<li>edate:</li>
<li>stateFIPS:</li>
<li>cbdate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* functions and <em>*quarterlysummary_by_</em>* functions).</li>
<li>cedate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>return_header (optional): set to FALSE by default.</li>
<li>duration (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>* functions).</li>
</ul>
<pre><code>aqs_qa_annualPeferomanceeval_by_MA  
aqs_qa_annualPeferomanceevaltransaction_by_MA  
aqs_qa_blanks_by_MA  
aqs_qa_collocated_assessments_by_MA  
aqs_qa_flowrateaudit_by_MA  
aqs_qa_flowrateverification_by_MA  
aqs_qa_one_point_qc_by_MA  
aqs_qa_pep_audit_by_MA  
aqs_transactionsample_by_MA</code></pre>
<p>functions in this family of functions aggregate data at the Monitoring Agency (MA) level. All functions accept the following variables:</p>
<ul>
<li>parameter:</li>
<li>bdate:</li>
<li>edate:</li>
<li>MA_code:</li>
<li>cbdate (optional): (This parameter is only used in conjunction with <em>*sampledataby</em>*, <em>*dailydataby</em>*, <em>*annualdataby</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>cedate (optional): (This parameter is only used in conjunction with <em>*sampledataby</em>*, <em>*dailydataby</em>*, <em>*annualdataby</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>return_header (optional): set to FALSE by default.</li>
<li>duration (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>* functions).</li>
</ul>
</div>
<div id="data-mart-aggregate-functions-by-core-based-statistical-area-cbsa" class="section level3">
<h3>Data Mart aggregate functions by Core Based Statistical Area (cbsa)</h3>
<pre><code>aqs_annualsummary_by_cbsa  
aqs_dailysummary_by_cbsa  
aqs_monitors_by_cbsa  
aqs_sampledata_by_cbsa</code></pre>
<p>functions in this family of functions aggregate data at the Core Based Statistical Area (cbsa, as defined by the US Census Bureau) level. All functions accept the following variables:</p>
<ul>
<li>parameter:</li>
<li>bdate:</li>
<li>edate:</li>
<li>cbsa_code:</li>
<li>cbdate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>cedate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>return_header (optional): set to FALSE by default.</li>
<li>duration (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>* functions).</li>
</ul>
</div>
<div id="data-mart-aggregate-functions-by-primary-quality-assurance-organization-pqao" class="section level3">
<h3>Data Mart aggregate functions by Primary Quality Assurance Organization (pqao)</h3>
<pre><code>aqs_qa_annualPeferomanceeval_by_pqao  
aqs_qa_annualPeferomanceevaltransaction_by_pqao  
aqs_qa_blanks_by_pqao  
aqs_qa_collocated_assessments_by_pqao  
aqs_qa_flowrateaudit_by_pqao  
aqs_qa_flowrateverification_by_pqao  
aqs_qa_one_point_qc_by_pqao  
aqs_qa_pep_audit_by_pqao  
aqs_quarterlysummary_by_pqao</code></pre>
<p>functions in this family of functions aggregate data at the Primary Quality Assurance Organization (pqao) level. All functions accept the following variables:</p>
<ul>
<li>parameter:</li>
<li>bdate:</li>
<li>edate:</li>
<li>pqao_code:</li>
<li>return_header (optional): set to FALSE by default.</li>
</ul>
</div>
<div id="data-mart-aggregate-functions-by-latitudelongitude-bounding-box-_by_box" class="section level3">
<h3>Data Mart aggregate functions by latitude/longitude bounding box (_by_box)</h3>
<pre><code>aqs_annualsummary_by_box  
aqs_dailysummary_by_box  
aqs_monitors_by_box  
aqs_quarterlysummary_by_box  
aqs_sampledata_by_box</code></pre>
<p>Functions in this family of functions aggregate data by a latitude/longitude bounding box (_by_box) level. All functions accept the following variables:</p>
<ul>
<li>parameter:</li>
<li>bdate:</li>
<li>edate:</li>
<li>minlat:</li>
<li>minlon:</li>
<li>maxlon:</li>
<li>maxlat:</li>
<li>cbdate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>cedate (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>*, <em>*dailydata_by_</em>*, <em>*annualdata_by_</em>* and <em>*quarterlysummary_by_</em>* functions).</li>
<li>return_header (optional): set to FALSE by default.</li>
<li>duration (optional): (This parameter is only used in conjunction with <em>*sampledata_by_</em>* functions).</li>
</ul>
</div>
<div id="data-mart-aggregate-functions-_by_state" class="section level3">
<h3>Data Mart aggregate functions _by_state</h3>
</div>
<div id="raqsapi-miscellaneous-functions" class="section level3">
<h3>RAQSAPI Miscellaneous functions</h3>
<pre><code>aqs_removeheader</code></pre>
<p>These are miscellaneous functions exported by RAQSAPI.</p>
<p>RAQSAPI::aqs_removeheader is the function that the RAQSAPI library uses internally to coerce an AQS_DATAMART_APIv2 S3 object into a tibble. This is useful if the user saves the output from another RAQSAPI function with return_header = TRUE set but later decides that they want just a simple tibble object. This function takes only one variable:</p>
<ul>
<li>AQSobject:</li>
</ul>
</div>
</div>
</div>
<div id="troubleshooting" class="section level1">
<h1>Troubleshooting</h1>
<p>parameters must be supplied exactly as they are specified, for example the stateFIPS for Alabama is “01,” entering a value of “1” for the stateFIPS may lead to unexpected results. Do not omit leading zeros in parameters that expect them.</p>
<p>In Functions that have the return_header=TRUE option set the returned object is an AQSAPI_v2 object, this is a 2 item list where the first object is a tibble with the label $Header the second, a tibble with the label $Data. sampledata functions are limited by the API to one calendar year of data per API call so if the user requests multiple years of data the sampledata call will return multiple AQSAPI_v2 objects, one for each call to the API. The returned result is a list of AQSAPI_v2 objects. In R to access the data in each item in the list the user will need to use the “double bracket operator” (“[[”, ”]]”) not the single bracket operator (“[”, ”]”).</p>
</div>
<div id="acknowledgements" class="section level1">
<h1>Acknowledgements</h1>
<p>RAQSAPI was included in the Rblogger’s March 2021: “Top 40” <a href="https://www.r-bloggers.com/2021/04/march-2021-top-40-new-cran-packages/">New CRAN Packages</a>.</p>
<p>The RAQSAPI package borrows upon functions and code provided by sources not mentioned in the DESCRIPTION file. Here we attempt to acknowledge those sources with them RAQSAPI would not be possible.</p>
<ul>
<li>README badges are provided by R package badgecreator<span class="citation"><sup>3</sup></span>.</li>
<li>The R package usethis<span class="citation"><sup>4</sup></span> was used to generate GitHub actions for Continuous integration (CI).</li>
<li>Code cleanup was assisted by the R package lintr<span class="citation"><sup>5</sup></span></li>
<li>the function <em>install.packages</em> are provided by the R package utils<span class="citation"><sup>6</sup></span></li>
<li>the function <em>install_github</em> are provided by the R package remotes<span class="citation"><sup>7</sup></span></li>
<li>.gitignore file borrowed examples from <a href="https://github.com/github/gitignore/blob/master/R.gitignore" class="uri">https://github.com/github/gitignore/blob/master/R.gitignore</a></li>
<li>The RAQSAPI hexsticker was created using the <code>hexSticker</code> package for R</li>
</ul>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body">
<div id="ref-AQSDataMartWelcome" class="csl-entry">
<div class="csl-left-margin">(1) </div><div class="csl-right-inline">AQS data mart welcome <a href="https://aqs.epa.gov/aqsweb/documents/data_mart_welcome.html">https://aqs.epa.gov/aqsweb/documents/data_mart_welcome.html</a>.</div>
</div>
<div id="ref-website:tibble" class="csl-entry">
<div class="csl-left-margin">(2) </div><div class="csl-right-inline">Müller, H., Kirill; Wickham. Tibble Part of the Tidyverse, 2019.</div>
</div>
<div id="ref-package:badgecreatr" class="csl-entry">
<div class="csl-left-margin">(3) </div><div class="csl-right-inline">Hogervorst, R. M. <em>Badgecreatr: Create Badges for ’Travis’, ’Repostatus’ ’Codecov.io’ Etc in Github Readme</em>; 2019.</div>
</div>
<div id="ref-package:usethis" class="csl-entry">
<div class="csl-left-margin">(4) </div><div class="csl-right-inline">Wickham, H.; Bryan, J. <em>Usethis: Automate Package and Project Setup</em>; 2021.</div>
</div>
<div id="ref-package:lintr" class="csl-entry">
<div class="csl-left-margin">(5) </div><div class="csl-right-inline">Hester, J.; Angly, F.; Hyde, R. <em>Lintr: A ’Linter’ for r Code</em>; 2020.</div>
</div>
<div id="ref-RBase" class="csl-entry">
<div class="csl-left-margin">(6) </div><div class="csl-right-inline">Team, R. C. <em>R: A Language and Environment for Statistical Computing</em>; R Foundation for Statistical Computing: Vienna, Austria, 2019.</div>
</div>
<div id="ref-package:remotes" class="csl-entry">
<div class="csl-left-margin">(7) </div><div class="csl-right-inline">Hester, J.; Csárdi, G.; Wickham, H.; Chang, W.; Morgan, M.; Tenenbaum, D. <em>Remotes: R Package Installation from Remote Repositories, Including ’GitHub’</em>; 2021.</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>RAQSAPI’s rate limit does not guarantee that the user will not go over the rate limit and does not guarantee that API calls do not overload the AQS Data Mart system, each user should monitor their requests independently.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Use “?aqs_sign_up” after the RAQSAPI library has been loaded to see the full usage description of the aqs_sign_up function.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Use “?aqs_credentials” after the RAQSAPI library has been loaded to see the full usage description of the aqs_credentials function.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>[R <code>Keyring</code> package]<a href="https://cran.r-project.org/package=keyring" class="uri">https://cran.r-project.org/package=keyring</a>)<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>See (<a href="https://aqs.epa.gov/aqsweb/documents/data_api.html" class="uri">https://aqs.epa.gov/aqsweb/documents/data_api.html</a>) for full details of the Data Mart API<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
